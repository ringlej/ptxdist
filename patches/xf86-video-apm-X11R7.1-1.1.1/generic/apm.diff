#
# Submitted-By: Erwin Rol, 2006-06-11
# Committed-By: Luotao Fu
#
# Error:
#
# XORG_CHECK_LINUXDOC uses AC_CHECK_FILE which is not
# crosscompile aware.
# Includes Systemheader direcotry which is not
# crosscompile aware.
#
# Description:
#
# short-circuit BUILD_LINUXDOC to false
# add ${SYSROOT} manually to INCLUDEs in configure
#
# State:
#
# not for upstream
#

--- xf86-video-apm-X11R7.1-1.1.1.orig/configure.ac	2006-04-08 03:14:51.000000000 +0200
+++ xf86-video-apm-X11R7.1-1.1.1/configure.ac	2006-06-21 10:32:23.844154804 +0200
@@ -63,7 +63,7 @@
 AC_SUBST([XF86RUSH_CFLAGS])
 
 CFLAGS="$CFLAGS $XORG_CFLAGS $XF86RUSH_CFLAGS"' -I$(top_srcdir)/src'
-INCLUDES="$XORG_INCS -I${sdkdir} $XF86RUSH_INCS "'-I$(top_srcdir)/src -I$(prefix)/include'
+INCLUDES="$XORG_INCS -I${SYSROOT}${sdkdir} $XF86RUSH_INCS "'-I$(top_srcdir)/src '"-I${SYSROOT}$(prefix)/include"
 AC_SUBST([CFLAGS])
 AC_SUBST([INCLUDES])
 
@@ -78,7 +78,8 @@
 XORG_MANPAGE_SECTIONS
 XORG_RELEASE_VERSION
 
-XORG_CHECK_LINUXDOC
+#XORG_CHECK_LINUXDOC
+AM_CONDITIONAL(BUILD_LINUXDOC, false)
 
 AC_OUTPUT([
 	Makefile
--- xf86-video-apm-X11R7.1-1.1.1.orig/configure	2006-05-23 05:29:00.000000000 +0200
+++ xf86-video-apm-X11R7.1-1.1.1/configure	2006-06-21 10:27:24.912755890 +0200
@@ -465,7 +465,7 @@
 # include <unistd.h>
 #endif"
 
-ac_subst_vars='SHELL PATH_SEPARATOR PACKAGE_NAME PACKAGE_TARNAME PACKAGE_VERSION PACKAGE_STRING PACKAGE_BUGREPORT exec_prefix prefix program_transform_name bindir sbindir libexecdir datadir sysconfdir sharedstatedir localstatedir libdir includedir oldincludedir infodir mandir build_alias host_alias target_alias DEFS ECHO_C ECHO_N ECHO_T LIBS INSTALL_PROGRAM INSTALL_SCRIPT INSTALL_DATA CYGPATH_W PACKAGE VERSION ACLOCAL AUTOCONF AUTOMAKE AUTOHEADER MAKEINFO install_sh STRIP ac_ct_STRIP INSTALL_STRIP_PROGRAM mkdir_p AWK SET_MAKE am__leading_dot AMTAR am__tar am__untar MAINTAINER_MODE_TRUE MAINTAINER_MODE_FALSE MAINT build build_cpu build_vendor build_os host host_cpu host_vendor host_os CC CFLAGS LDFLAGS CPPFLAGS ac_ct_CC EXEEXT OBJEXT DEPDIR am__include am__quote AMDEP_TRUE AMDEP_FALSE AMDEPBACKSLASH CCDEPMODE am__fastdepCC_TRUE am__fastdepCC_FALSE EGREP LN_S ECHO AR ac_ct_AR RANLIB ac_ct_RANLIB CPP CXX CXXFLAGS ac_ct_CXX CXXDEPMODE am__fastdepCXX_TRUE am__fastdepCXX_FALSE CXXCPP F77 FFLAGS ac_ct_F77 LIBTOOL moduledir PKG_CONFIG ac_pt_PKG_CONFIG XORG_CFLAGS XORG_LIBS XF86RUSH_CFLAGS XF86RUSH_LIBS XF86RUSH_TRUE XF86RUSH_FALSE INCLUDES DRIVER_NAME APP_MAN_SUFFIX LIB_MAN_SUFFIX FILE_MAN_SUFFIX MISC_MAN_SUFFIX DRIVER_MAN_SUFFIX ADMIN_MAN_SUFFIX APP_MAN_DIR LIB_MAN_DIR FILE_MAN_DIR MISC_MAN_DIR DRIVER_MAN_DIR ADMIN_MAN_DIR LINUXDOC PS2PDF BUILD_LINUXDOC_TRUE BUILD_LINUXDOC_FALSE BUILD_PDFDOC_TRUE BUILD_PDFDOC_FALSE MAKE_TEXT MAKE_PS MAKE_PDF MAKE_HTML LIBOBJS LTLIBOBJS'
+ac_subst_vars='SHELL PATH_SEPARATOR PACKAGE_NAME PACKAGE_TARNAME PACKAGE_VERSION PACKAGE_STRING PACKAGE_BUGREPORT exec_prefix prefix program_transform_name bindir sbindir libexecdir datadir sysconfdir sharedstatedir localstatedir libdir includedir oldincludedir infodir mandir build_alias host_alias target_alias DEFS ECHO_C ECHO_N ECHO_T LIBS INSTALL_PROGRAM INSTALL_SCRIPT INSTALL_DATA CYGPATH_W PACKAGE VERSION ACLOCAL AUTOCONF AUTOMAKE AUTOHEADER MAKEINFO install_sh STRIP ac_ct_STRIP INSTALL_STRIP_PROGRAM mkdir_p AWK SET_MAKE am__leading_dot AMTAR am__tar am__untar MAINTAINER_MODE_TRUE MAINTAINER_MODE_FALSE MAINT build build_cpu build_vendor build_os host host_cpu host_vendor host_os CC CFLAGS LDFLAGS CPPFLAGS ac_ct_CC EXEEXT OBJEXT DEPDIR am__include am__quote AMDEP_TRUE AMDEP_FALSE AMDEPBACKSLASH CCDEPMODE am__fastdepCC_TRUE am__fastdepCC_FALSE EGREP LN_S ECHO AR ac_ct_AR RANLIB ac_ct_RANLIB CPP CXX CXXFLAGS ac_ct_CXX CXXDEPMODE am__fastdepCXX_TRUE am__fastdepCXX_FALSE CXXCPP F77 FFLAGS ac_ct_F77 LIBTOOL moduledir PKG_CONFIG ac_pt_PKG_CONFIG XORG_CFLAGS XORG_LIBS XF86RUSH_CFLAGS XF86RUSH_LIBS XF86RUSH_TRUE XF86RUSH_FALSE INCLUDES DRIVER_NAME APP_MAN_SUFFIX LIB_MAN_SUFFIX FILE_MAN_SUFFIX MISC_MAN_SUFFIX DRIVER_MAN_SUFFIX ADMIN_MAN_SUFFIX APP_MAN_DIR LIB_MAN_DIR FILE_MAN_DIR MISC_MAN_DIR DRIVER_MAN_DIR ADMIN_MAN_DIR BUILD_LINUXDOC_TRUE BUILD_LINUXDOC_FALSE LIBOBJS LTLIBOBJS'
 ac_subst_files=''
 
 # Initialize some variables set by options.
@@ -19514,7 +19514,7 @@
 # Checks for extensions
 
 	SAVE_CFLAGS="$CFLAGS"
-	CFLAGS="$CFLAGS -I`pkg-config --variable=sdkdir xorg-server`"
+	CFLAGS="$CFLAGS -I${SYSROOT}`pkg-config --variable=sdkdir xorg-server`"
 	cat >conftest.$ac_ext <<_ACEOF
 /* confdefs.h.  */
 _ACEOF
@@ -19576,7 +19576,7 @@
 
 
 	SAVE_CFLAGS="$CFLAGS"
-	CFLAGS="$CFLAGS -I`pkg-config --variable=sdkdir xorg-server`"
+	CFLAGS="$CFLAGS -I${SYSROOT}`pkg-config --variable=sdkdir xorg-server`"
 	cat >conftest.$ac_ext <<_ACEOF
 /* confdefs.h.  */
 _ACEOF
@@ -19638,7 +19638,7 @@
 
 
 	SAVE_CFLAGS="$CFLAGS"
-	CFLAGS="$CFLAGS -I`pkg-config --variable=sdkdir xorg-server`"
+	CFLAGS="$CFLAGS -I${SYSROOT}`pkg-config --variable=sdkdir xorg-server`"
 	cat >conftest.$ac_ext <<_ACEOF
 /* confdefs.h.  */
 _ACEOF
@@ -19700,7 +19700,7 @@
 
 
 	SAVE_CFLAGS="$CFLAGS"
-	CFLAGS="$CFLAGS -I`pkg-config --variable=sdkdir xorg-server`"
+	CFLAGS="$CFLAGS -I${SYSROOT}`pkg-config --variable=sdkdir xorg-server`"
 	cat >conftest.$ac_ext <<_ACEOF
 /* confdefs.h.  */
 _ACEOF
@@ -20063,7 +20063,7 @@
 
 
 CFLAGS="$CFLAGS $XORG_CFLAGS $XF86RUSH_CFLAGS"' -I$(top_srcdir)/src'
-INCLUDES="$XORG_INCS -I${sdkdir} $XF86RUSH_INCS "'-I$(top_srcdir)/src -I$(prefix)/include'
+INCLUDES="$XORG_INCS -I${SYSROOT}${sdkdir} $XF86RUSH_INCS "'-I$(top_srcdir)/src '"-I${SYSROOT}$(prefix)/include"
 
 
 
@@ -20356,124 +20356,10 @@
 	fi
 
 
-
-as_ac_File=`echo "ac_cv_file_$prefix/share/X11/sgml/defs.ent" | $as_tr_sh`
-echo "$as_me:$LINENO: checking for $prefix/share/X11/sgml/defs.ent" >&5
-echo $ECHO_N "checking for $prefix/share/X11/sgml/defs.ent... $ECHO_C" >&6
-if eval "test \"\${$as_ac_File+set}\" = set"; then
-  echo $ECHO_N "(cached) $ECHO_C" >&6
-else
-  test "$cross_compiling" = yes &&
-  { { echo "$as_me:$LINENO: error: cannot check for file existence when cross compiling" >&5
-echo "$as_me: error: cannot check for file existence when cross compiling" >&2;}
-   { (exit 1); exit 1; }; }
-if test -r "$prefix/share/X11/sgml/defs.ent"; then
-  eval "$as_ac_File=yes"
-else
-  eval "$as_ac_File=no"
-fi
-fi
-echo "$as_me:$LINENO: result: `eval echo '${'$as_ac_File'}'`" >&5
-echo "${ECHO_T}`eval echo '${'$as_ac_File'}'`" >&6
-if test `eval echo '${'$as_ac_File'}'` = yes; then
-  DEFS_ENT_PATH=$prefix/share/X11/sgml
-else
-  DEFS_ENT_PATH=
-
-fi
-
-
-# Extract the first word of "linuxdoc", so it can be a program name with args.
-set dummy linuxdoc; ac_word=$2
-echo "$as_me:$LINENO: checking for $ac_word" >&5
-echo $ECHO_N "checking for $ac_word... $ECHO_C" >&6
-if test "${ac_cv_path_LINUXDOC+set}" = set; then
-  echo $ECHO_N "(cached) $ECHO_C" >&6
-else
-  case $LINUXDOC in
-  [\\/]* | ?:[\\/]*)
-  ac_cv_path_LINUXDOC="$LINUXDOC" # Let the user override the test with a path.
-  ;;
-  *)
-  as_save_IFS=$IFS; IFS=$PATH_SEPARATOR
-for as_dir in $PATH
-do
-  IFS=$as_save_IFS
-  test -z "$as_dir" && as_dir=.
-  for ac_exec_ext in '' $ac_executable_extensions; do
-  if $as_executable_p "$as_dir/$ac_word$ac_exec_ext"; then
-    ac_cv_path_LINUXDOC="$as_dir/$ac_word$ac_exec_ext"
-    echo "$as_me:$LINENO: found $as_dir/$ac_word$ac_exec_ext" >&5
-    break 2
-  fi
-done
-done
-
-  ;;
-esac
-fi
-LINUXDOC=$ac_cv_path_LINUXDOC
-
-if test -n "$LINUXDOC"; then
-  echo "$as_me:$LINENO: result: $LINUXDOC" >&5
-echo "${ECHO_T}$LINUXDOC" >&6
-else
-  echo "$as_me:$LINENO: result: no" >&5
-echo "${ECHO_T}no" >&6
-fi
-
-# Extract the first word of "ps2pdf", so it can be a program name with args.
-set dummy ps2pdf; ac_word=$2
-echo "$as_me:$LINENO: checking for $ac_word" >&5
-echo $ECHO_N "checking for $ac_word... $ECHO_C" >&6
-if test "${ac_cv_path_PS2PDF+set}" = set; then
-  echo $ECHO_N "(cached) $ECHO_C" >&6
-else
-  case $PS2PDF in
-  [\\/]* | ?:[\\/]*)
-  ac_cv_path_PS2PDF="$PS2PDF" # Let the user override the test with a path.
-  ;;
-  *)
-  as_save_IFS=$IFS; IFS=$PATH_SEPARATOR
-for as_dir in $PATH
-do
-  IFS=$as_save_IFS
-  test -z "$as_dir" && as_dir=.
-  for ac_exec_ext in '' $ac_executable_extensions; do
-  if $as_executable_p "$as_dir/$ac_word$ac_exec_ext"; then
-    ac_cv_path_PS2PDF="$as_dir/$ac_word$ac_exec_ext"
-    echo "$as_me:$LINENO: found $as_dir/$ac_word$ac_exec_ext" >&5
-    break 2
-  fi
-done
-done
-
-  ;;
-esac
-fi
-PS2PDF=$ac_cv_path_PS2PDF
-
-if test -n "$PS2PDF"; then
-  echo "$as_me:$LINENO: result: $PS2PDF" >&5
-echo "${ECHO_T}$PS2PDF" >&6
-else
-  echo "$as_me:$LINENO: result: no" >&5
-echo "${ECHO_T}no" >&6
-fi
-
-
-echo "$as_me:$LINENO: checking Whether to build documentation" >&5
-echo $ECHO_N "checking Whether to build documentation... $ECHO_C" >&6
-
-if test x$DEFS_ENT_PATH != x && test x$LINUXDOC != x ; then
-   BUILDDOC=yes
-else
-   BUILDDOC=no
-fi
+#XORG_CHECK_LINUXDOC
 
 
-
-if test x$BUILDDOC = xyes; then
+if false; then
   BUILD_LINUXDOC_TRUE=
   BUILD_LINUXDOC_FALSE='#'
 else
@@ -20482,43 +20368,6 @@
 fi
 
 
-echo "$as_me:$LINENO: result: $BUILDDOC" >&5
-echo "${ECHO_T}$BUILDDOC" >&6
-
-echo "$as_me:$LINENO: checking Whether to build pdf documentation" >&5
-echo $ECHO_N "checking Whether to build pdf documentation... $ECHO_C" >&6
-
-if test x$PS2PDF != x ; then
-   BUILDPDFDOC=yes
-else
-   BUILDPDFDOC=no
-fi
-
-
-
-if test x$BUILDPDFDOC = xyes; then
-  BUILD_PDFDOC_TRUE=
-  BUILD_PDFDOC_FALSE='#'
-else
-  BUILD_PDFDOC_TRUE='#'
-  BUILD_PDFDOC_FALSE=
-fi
-
-
-echo "$as_me:$LINENO: result: $BUILDPDFDOC" >&5
-echo "${ECHO_T}$BUILDPDFDOC" >&6
-
-MAKE_TEXT="SGML_SEARCH_PATH=$DEFS_ENT_PATH GROFF_NO_SGR=y $LINUXDOC -B txt"
-MAKE_PS="SGML_SEARCH_PATH=$DEFS_ENT_PATH $LINUXDOC -B latex --papersize=letter --output=ps"
-MAKE_PDF="$PS2PDF"
-MAKE_HTML="SGML_SEARCH_PATH=$DEFS_ENT_PATH $LINUXDOC  -B html --split=0"
-
-
-
-
-
-
-
                               ac_config_files="$ac_config_files Makefile src/Makefile man/Makefile"
 cat >confcache <<\_ACEOF
 # This file is a shell script that caches the results of configure
@@ -20660,13 +20509,6 @@
 Usually this means the macro was only invoked conditionally." >&2;}
    { (exit 1); exit 1; }; }
 fi
-if test -z "${BUILD_PDFDOC_TRUE}" && test -z "${BUILD_PDFDOC_FALSE}"; then
-  { { echo "$as_me:$LINENO: error: conditional \"BUILD_PDFDOC\" was never defined.
-Usually this means the macro was only invoked conditionally." >&5
-echo "$as_me: error: conditional \"BUILD_PDFDOC\" was never defined.
-Usually this means the macro was only invoked conditionally." >&2;}
-   { (exit 1); exit 1; }; }
-fi
 
 : ${CONFIG_STATUS=./config.status}
 ac_clean_files_save=$ac_clean_files
@@ -21292,16 +21134,8 @@
 s,@MISC_MAN_DIR@,$MISC_MAN_DIR,;t t
 s,@DRIVER_MAN_DIR@,$DRIVER_MAN_DIR,;t t
 s,@ADMIN_MAN_DIR@,$ADMIN_MAN_DIR,;t t
-s,@LINUXDOC@,$LINUXDOC,;t t
-s,@PS2PDF@,$PS2PDF,;t t
 s,@BUILD_LINUXDOC_TRUE@,$BUILD_LINUXDOC_TRUE,;t t
 s,@BUILD_LINUXDOC_FALSE@,$BUILD_LINUXDOC_FALSE,;t t
-s,@BUILD_PDFDOC_TRUE@,$BUILD_PDFDOC_TRUE,;t t
-s,@BUILD_PDFDOC_FALSE@,$BUILD_PDFDOC_FALSE,;t t
-s,@MAKE_TEXT@,$MAKE_TEXT,;t t
-s,@MAKE_PS@,$MAKE_PS,;t t
-s,@MAKE_PDF@,$MAKE_PDF,;t t
-s,@MAKE_HTML@,$MAKE_HTML,;t t
 s,@LIBOBJS@,$LIBOBJS,;t t
 s,@LTLIBOBJS@,$LTLIBOBJS,;t t
 CEOF
