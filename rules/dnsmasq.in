## SECTION=networking
#
# dnsmasq configuration
#
menuconfig DNSMASQ
	tristate
	prompt "dnsmasq                       "
	select DBUS if DNSMASQ_DBUS
	help
	  A small caching DNS proxy and DHCP server.

 	  Dnsmasq is lightweight, easy to configure DNS forwarder
	  and DHCP server. It is designed to provide DNS and,
	  optionally, DHCP, to a small network. It can serve the
	  names of local machines which are not in the global DNS.
	  The DHCP server integrates with the DNS server and allows
	  machines with DHCP-allocated addresses to appear in the DNS
	  with names configured either in each host or in a central
	  configuration file. Dnsmasq supports static and dynamic
 	  DHCP leases and BOOTP for network booting of diskless machines.
	  Note: In order to make dnsmasq work as DHCP, you have to enable
	  the following kernel features: FIXME

if DNSMASQ

comment "build options   ---"

config DNSMASQ_DBUS
	bool
	prompt "include DBUS support"
	help
	  This enables DBUS support in dnsmasq. This is not only a build
	  option. You also have to enable it at runtime. FIXME: Show how,
	  see DBUS document in dnsmasq packet

comment "runtime options   ---"

choice
	prompt "Kind of startup"

	config DNSMASQ_INETD_SERVER
		bool
		prompt "inetd driven"
		help
		 dnsmasq will be started on demand from inetd. This installs
		 a startup configuration for dnsmasq from inetd. It adds to the
		 /etc/inetd.conf a line like this:
		 domain stream tcp nowait root /sbin/dnsmasq domain
		 Note: You must enable one of the two possible inet daemons:
		 There is one embedded in busybox and one in packet inetutils.
		 Note: If you want to use dnsmasq's DHCP feature, you can't
		 run it from inetd. In this case you need the standalone
		 startscript!

	config DNSMASQ_STARTUP_TYPE_STANDALONE
		bool
		prompt "standalone"
		help
		  This installs dnsmasq startup script /etc/init.d/dnsmasq.
		  With this script the dnsmasq server will be started at system
		  startup and waits for any kind of DHCP or DNS requests.

endchoice

config DNSMASQ_INETD_STRING
	string
	depends on DNSMASQ_INETD_SERVER
	prompt "inetd service entry"
	default "domain stream tcp nowait root /sbin/dnsmasq domain"
	help
	  This string is added to inetd's configuration /etc/inetd.conf.

config DNSMASQ_STARTSCRIPT
	bool
	default y
	prompt "install /etc/init.d/dnsmasq"

endif
