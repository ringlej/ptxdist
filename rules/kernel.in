#
# rules/kernel.in
#

menuconfig KERNEL
	bool
	default y
	select CROSS_MODULE_INIT_TOOLS if KERNEL_MODULES
	select HOST_UMKIMAGE if KERNEL_IMAGE_U
	prompt "linux kernel                  "

comment "--------- Target's kernel ----------"
	depends on KERNEL

comment "build options   ---"
	depends on KERNEL

config KERNEL_VERSION
	prompt "linux kernel Version"
	depends on KERNEL
	string
	default "2.6.19"

choice
	prompt "kernel architecture (ppc/powerpc)"
	depends on KERNEL
	depends on ARCH_PPC
	default KERNEL_ARCH_POWERPC
	help
	  In current 2.6 kernels powerpc is supported in two
	  different architectures. ppc is the old one and currently
	  gets merged into powerpc.

	config KERNEL_ARCH_PPC
		bool
		prompt "ppc"

	config KERNEL_ARCH_POWERPC
		bool
		prompt "powerpc"
endchoice

config KERNEL_ARCH
	depends on KERNEL
	string
	default "arm"			if ARCH_ARM
	default "armnommu"		if ARCH_ARM_NOMMU
	default "alpha"			if ARCH_ALPHA
	default "i386"			if ARCH_X86
	default "m68k"			if ARCH_M68K
	default "sparc"			if ARCH_SPARC
	default "mips"			if ARCH_MIPS
	default "mips"			if ARCH_MIPSEL
	default "cris"			if ARCH_CRIS
	default "parisc"		if ARCH_PARISC
	default "sh"			if ARCH_SH

	default "ppc"			if KERNEL_ARCH_PPC
	default "powerpc"		if KERNEL_ARCH_POWERPC

config KERNEL_SERIES
	prompt "Patch Series File"
	depends on KERNEL
	string
	default ""
	help
	  This entry specifies a patch series file which has to live in
	  the kernel patches directory:

	  The series file contains lines with names of patch files which
	  are then being applied to the kernel.

config KERNEL_CONFIG
	prompt "kernel config file"
	depends on KERNEL
	string
	default "kernelconfig.target"
	help
	  tris entry specifies the .config file used to compile your kernel

config KERNEL_MODULES
	bool
	default y
	prompt "build kernel-modules"
	depends on KERNEL

choice
	prompt "Image Type"
	default KERNEL_IMAGE_BZ
	depends on KERNEL

config KERNEL_IMAGE_BZ
	bool
	prompt "bzImage"
	help
	 This usually is the target to be used on ia32 platforms. It
	 is not limited in size (to be more precise: Limited up to 4MiB).

config KERNEL_IMAGE_Z
	bool
	prompt "zImage"
	help
	 This usually is the target to be used on ia32 platforms, it
	 is the older format and limited to about 500k in size due to
	 low memory size restrictions.

config KERNEL_IMAGE_U
	bool
	prompt "uImage"
	help
	 This is the target for most non ia32 platforms like PowerPC
	 and ARM architectures. Its a compressed image with additional
	 embedded information.

config KERNEL_IMAGE_VMLINUX
	bool
	prompt "vmlinux"
	help
	 This is the target to get the kernel image as an ELF. Mostly
	 used for debugging purposes.
endchoice

comment "install options   ---"
	depends on KERNEL

config KERNEL_INSTALL
	bool
	prompt "install kernel into /boot"
	depends on KERNEL

config KERNEL_MODULES_INSTALL
	bool
	default y
	prompt "Install modules into /lib/modules"
	depends on KERNEL
	depends on KERNEL_MODULES

config KERNEL_IMAGE
	depends on KERNEL
	string
	default "bzImage" if KERNEL_IMAGE_BZ
	default "zImage"  if KERNEL_IMAGE_Z
	default "uImage"  if KERNEL_IMAGE_U
	default "vmlinux" if KERNEL_IMAGE_VMLINUX

config KERNEL_MODULES_BUILD
	depends on KERNEL
	depends on KERNEL_MODULES
	string
	default "modules"

comment "--------- Emulation kernel ---------"
	depends on KERNEL

menu  "emulation options             "
	depends on KERNEL

config KERNEL_NATIVE_VERSION
	prompt "Native Kernel Version"
	string
	default "2.6.15"

config KERNEL_NATIVE_SERIES
	prompt "Patch Series File"
	string
	default "series"
	help
	  This entry specifies a patch series file which has to live in
	  this directory:

		$PTXDIST_WORKSPACE/kernel-patches-native

	  The series file contains lines with names of patch files which
	  are then being applied to the kernel.

config KERNEL_NATIVE_CONFIG
	prompt "native kernel config file"
	string
	default "kernelconfig.native"
	help
	  This entry specifies the .config file used to compile your kernel

choice
	prompt "Root Filesystem Method"

	config KERNEL_NATIVE_ROOT_HOSTFS
		bool
		prompt "hostfs"
		help
		  Using the hostfs method, ${ROOTDIR} is shared between
		  the host and the user mode linux machine.

endchoice

config KERNEL_NATIVE_CONSOLE_STDSERIAL
	bool
	prompt "map /dev/ttyS0 to stdio"
	help
	  This switch adds "ssl0=fd:0,fd:1" to the kernel command line,
	  which forwards /dev/ttyS0 of the user mode linux vm to the
	  host's stdin/stdout.

config KERNEL_NATIVE_CMDLINE
	string
	prompt "kernel command line"
	default "root/boot/vmlinux root=/dev/root rootflags=${ROOTDIR} rootfstype=hostfs"
	help
	  Add your custom kernel commandline for the user mode linux
	  kernel here. A sane default for hostfs in PTXdist is

	  root/boot/vmlinux root=/dev/root rootflags=${ROOTDIR} rootfstype=hostfs

endmenu
